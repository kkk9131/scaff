2025-09-11 初期化: Git リポジトリを作成し、AGENTS（英/日）と .gitignore を追加。GitHub リモート接続・main ブランチを push。
2025-09-11 追記: 言語方針/コメント/チェックリスト/二言語ドキュメント/ログ運用を AGENTS に追加。activity.log 運用開始。
2025-09-11 ドキュメント: 開発フロー（英/日）を追加し、README からリンク。
2025-09-11 ガイド: AGENTS に開発フロー順守を追記（英/日）。
2025-09-11 設定: CODEOWNERS を追加し、コードレビュー自動依頼を有効化。
2025-09-11 開発: フェーズ1スケルトン（Next.js+TS+Tailwind、UI骨格/Canvas仮）を追加。README更新。
2025-09-11 チェックリスト: フェーズ1の達成項目（Next.js環境/サイドバー/キャンバス/上部バー）を docs/開発ロードマップ.md でチェック。
2025-09-11 設定: shadcn/ui 用ボイラープレート追加（tailwindcss-animate、utils、Button、components.json）。
2025-09-11 完了: Tailwind + shadcn/ui 導入をチェックし、.gitignore に .next/ を追加。
2025-09-11 開発: Three.js + postprocessing の最小プレースホルダーを追加（3Dビュー切替対応）。
2025-09-11 ドキュメント: 開発フローをブランチ運用版に更新（英/日）。
2025-09-11 実装: フェーズ2 最小実装（内部モデルmm/座標系/スケール）を追加し、初期長方形（8000mm×6000mm）をCanvasに描画。リサイズ対応。
2025-09-11 ドキュメント: docs/2D-内部モデル_座標・単位・スケール.md を追加。ロードマップの「テンプレート呼び出し（長方形）」にチェック。
2025-09-11 実装: テンプレート追加（L字／コの字／T字）。内部モデルで多角形生成（mm）＋Canvas描画に対応。サイドバーからテンプレート切替を追加。
2025-09-11 チェックリスト: ロードマップの「テンプレート呼び出し（L字／コの字／T字）」にチェック。
2025-09-11 ドキュメント: ロードマップの競合マーカーを解消し、テンプレート（L/U/T）完了チェックを確定。
2025-09-12 15:15: フェーズ2開始用ブランチ 'phase-2' を作成
2025-09-12 15:21: 平面図の矩形で辺クリック→mm入力の寸法編集を実装（CanvasArea）。
2025-09-12 15:25: 寸法入力プロンプトを方位（北/東/南/西）表記へ変更。Canvasラベルも東西/南北表記に統一。
2025-09-12 15:33: L/U/T テンプレートの辺クリック→方位に基づく寸法入力を実装（外形寸法＋切欠/開口/バー・柱）。
2025-09-12 15:40: 非矩形の辺名称を『辺n方位』に統一。プロンプトに反映（L/U/T/T）。
2025-09-12 15:45: T字の南向き短辺（辺3/辺7）に編集を割当。入力=短辺東西長→バー幅再計算。
2025-09-12 15:49: ロードマップ更新: フェーズ2『寸法入力』を完了に変更（矩形/L/U/T, 辺番号+方位）。
2025-09-12 main 更新: origin/main を fast-forward で取り込み。
2025-09-12 ブランチ作成: フェーズ2『頂点ドラッグ編集（寸法自動更新）』着手用に 'feat/phase2-vertex-drag' を作成。
2025-09-12 ブランチ公開: 'feat/phase2-vertex-drag' を origin に push（追跡設定）。
2025-09-12 実装開始: キャンバスで頂点ハンドル表示と矩形の頂点ドラッグ→寸法自動更新（中心固定）を追加。transform に screenToModel を追加。
2025-09-12 実装: L/U/T の頂点ドラッグに対応（各頂点に応じて外形寸法・開口/切欠・バー/柱寸法を再計算）。
2025-09-12 修正: テンプレート切替が即時反映されるよう描画の再呼び出しを追加（サイドバーの開閉不要）。
2025-09-12 ロードマップ更新: フェーズ2『頂点ドラッグ編集（寸法自動更新）』を完了に変更。
2025-09-12 ブランチ作成: フェーズ2『スナップ機能（直角・グリッド吸着）』対応で 'feat/phase2-snap-orthogonal-grid' を作成。
2025-09-12 仕様追加: スナップ機能の仕様（日本語/英語）を docs/ に追加（直角±7.5°、グリッド50mm、直角→グリッド適用順）。
2025-09-12 実装: src/core/snap.ts に純粋関数群（snapToGrid/snapToOrtho/applySnaps）を追加。
2025-09-12 統合: Canvas のドラッグ処理にスナップ適用。グリッドの薄い可視化を追加。README（英/日）を更新。
2025-09-12 UI: サイドバーにスナップ設定（グリッドON/OFF・間隔、直角ON/OFF・許容角）を追加。ショートカット（g/o）を実装。
2025-09-12 UI: サイドバー各セクションの開閉アイコンを lucide-react の Chevron に変更（絵文字から置換）。デフォルトは閉。
2025-09-12 ロードマップ更新: フェーズ2『スナップ機能（直角・グリッド吸着）』を完了に変更。
2025-09-12 main 更新: origin/main を fast-forward で取り込み（スナップ機能・UI設定を反映）。

2025-09-12: フェーズ2着手、ブランチ作成、スキャフォールド追加
- 新規ブランチ `feat/phase2-dimensions-always-visible` を作成
- 設計ドキュメント `docs/design/dimensions-always-visible.md` を追加
- コア骨組み `src/core/dimensions/` （モデル/エンジン）を追加
- テスト雛形 `tests/core/dimensions/dimension_engine.spec.ts` を追加
- リポジトリ概要 `README.ja.md` を追加

2025-09-12: デモ追加・JSエンジン用意
- ブラウザ用JS版エンジン `src/core/dimensions/dimension-engine.js` を追加
- ビルド不要のSVGデモ `assets/demo-dimensions/index.html` を追加
- READMEにデモの使い方を追記

2025-09-12: UI統合モジュール追加
- SVGレンダラ `src/ui/svg/dimension-renderer.js` を追加
- UI統合デモ `assets/demo-dimensions/index-ui.html` を追加
- READMEにUI統合デモの説明を追記

2025-09-12: 直開き対応インライン版デモ追加
- `assets/demo-dimensions/index-ui-inline.html` を追加（ESM不要、file直開きでも動作）
- READMEにローカルHTTPサーバ手順とインライン版の案内を追記

2025-09-13 00:25: activity.log の運用ルールを AGENTS に追記
- `AGENTS.md` と `AGENTS.ja.md` に activity.log の統一書式（append-only/JST/箇条書き/秘密情報禁止）を追加
- 以後は追記のみ。既存行の削除・書換・並べ替えを禁止

2025-09-13 00:40: 外側判定の厳密化を実装（CW/CCW自動）
- コア: `computeForPolygon(points)` を追加し、shoelace 面積で CCW/CW を判定
- ルール: CCW→右法線が外側、CW→左法線が外側（画面座標前提）
- UI: `outsideMode`（auto/left/right）を追加し、デモにラジオボタンで切替を追加
- ドキュメント: 設計/README を更新

2025-09-13 00:55: インライン版デモの描画を堅牢化
- CSSが効かない環境でも線が見えるよう、SVG要素に `stroke`/`stroke-width`/`fill` を直接指定

2025-09-13 01:05: ラベル衝突回避を追加
- UI: `src/ui/svg/dimension-renderer.js` に簡易衝突回避を実装（BBox交差検出→外側法線方向へ段階オフセット）
- README/設計ドキュメントを更新

2025-09-13 01:25: CanvasArea に寸法オーバーレイを統合
- `src/components/CanvasArea.tsx` に SVG オーバーレイを追加（絶対配置）
- コア `DimensionEngine` を用いて多角形のCW/CCWから外側を自動判定し、寸法線＋ラベルを描画
